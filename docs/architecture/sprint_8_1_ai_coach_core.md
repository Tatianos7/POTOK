# Sprint 8.1 — AI Coach Core (MVP)

## 1. Цель Phase 8.1
Создать первого живого AI‑коуча как продуктовую сущность: устойчивую личность,
которая поддерживает пользователя, соблюдает безопасность, объясняет решения и
способна опираться на долгосрочную память без давления и манипуляций.

## 2. System Architecture
**Coach Orchestrator**
- Координация контекста, доверия, тональности и guardrails.
- Выбор режима ответа: поддержка, совет, вопрос, объяснение, тишина.

**Memory Layers**
- Short (текущий сигнал): настроение, энергия, контекст дня.
- Session (сессия): диалог, текущая задача, решения и отказ.
- Long‑Term Identity: цели, ценности, ограничения, паттерны.

**Retrieval Sources**
- Goals
- Measurements
- Food
- Training
- Habits
- Progress
- Programs

**Trust & Safety Layer**
- Классификация рисков, запреты, деликатный тон.

**Explainability Layer**
- Источники, уверенность, ограничения, альтернативы.

**Emotion & Motivation Layer**
- Регулировка тона под усталость, тревогу, выгорание, кризис.

## 3. Reasoning Pipeline
**Вход**
- Состояние пользователя: физика, поведение, эмоции, доверие, энергия.

**Контекст**
- История, привычки, прогресс, срывы, планы, ограничения.

**Решение**
- Что сказать, что предложить, что не говорить.

**Guardrails**
- Медицинские, психологические, этические запреты.

**Выход**
- Ответ, план, вопрос, поддержка, объяснение.

## 4. Memory Model
**Хранится всегда**
- Цели, ценности, медицинские ограничения, согласия, критичные флаги.

**Забывается**
- Эмоциональные всплески без повторяемости.
- Случайные события без влияния на безопасность.

**Обобщается**
- Повторяющиеся паттерны усталости, срывов, восстановления.
- Долгие циклы мотивации/выгорания.

**Используется для адаптации**
- Доверие, устойчивость ритма, риск‑паттерны, долгосрочные цели.

## 5. Explainability Contract
AI‑коуч обязан выдавать:
- **Почему совет** (триггер/контекст).
- **На чём основан** (источники данных).
- **Уровень уверенности** (confidence).
- **Ограничения** (что не знает/что может быть ошибочно).
- **Альтернативы** (2–3 безопасных пути).

## 6. Safety & Trust
**Эмоциональные состояния**
- тревога, усталость, выгорание, регресс, стыд.

**Кризисные флаги**
- выраженный дистресс, самоуничижение, риски для здоровья.

**Когда AI должен замолчать**
- низкий trust score
- признаки кризиса
- отсутствие согласия на чувствительные темы

**Когда направлять к человеку**
- повторяющиеся кризисные сигналы
- медицинские риски
- устойчивый регресс с эмоциональной нестабильностью

## 7. Интеграция с текущей платформой
- **Today**: ежедневные подсказки и микро‑поддержка.
- **My Program**: объяснение адаптаций и поддержка изменений.
- **Progress**: осмысление динамики и устойчивости.
- **Habits**: поддержка ритма и возврат после срывов.
- **Profile**: прозрачность памяти, контроль, согласия.
- **Paywall**: нейтральное объяснение ценности, без давления.

## 8. E2E сценарии 200–215
- Первый диалог: безопасное знакомство и границы.
- Поддержка после срыва: мягкое восстановление ритма.
- Мотивация при плато: переосмысление и микро‑цели.
- Объяснение адаптации: причина, источники, уверенность.
- Отказ от плана: уважение решения, безопасная альтернатива.
- Возврат после паузы: мягкий ре‑онбординг.
- Долгосрочный рост доверия: последовательность и прозрачность.

## 9. Definition of Done — Phase 8.1
- AI‑коуч имеет стабильную личность Calm Power Coach.
- Работают short/session/long‑term memory слои.
- Trust & Safety блокирует опасные ответы и снижает давление.
- Explainability присутствует в ключевых советах и адаптациях.
- Эмоциональные состояния корректно распознаются и отражаются в тоне.
- Интеграции с Today / Program / Progress / Habits работают.
- E2E сценарии 200–215 описаны и покрыты MVP‑логикой.
